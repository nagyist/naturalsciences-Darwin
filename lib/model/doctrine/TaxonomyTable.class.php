<?php
/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class TaxonomyTable extends DarwinTable
{

  public function getTaxonByName($name,$level,$path)
  {
    $q = Doctrine_Query::create()
      ->from('Taxonomy t')
      ->where('t.name = ?', $name)
      ->andWhere('t.level_ref = ?', $level)
      ->andWhere('t.path = ?', $path);

    return $q->fetchOne();
  }

  public function getRealTaxon()
  {
    $q = Doctrine_Query::create()
      ->from('Taxonomy t')
      ->where('t.id > 0') ;
      return $q->execute() ;
  }
  
  public function getOneTaxon($taxonName) 
  {
    $response = Doctrine_Query::create()
               ->select('t.name, l.level_name')
               ->from('Taxonomy t')
               ->where('t.name_indexed = fullToIndex(?)', $taxonName)
               ->leftJoin('t.Level l')
               ->limit(2)
               ->execute(array(), Doctrine_Core::HYDRATE_ARRAY);

    return $response;
  }
}
